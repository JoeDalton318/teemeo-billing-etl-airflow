# ==============================================================================
# Configuration des variables d'environnement pour Teemeo Billing ETL
# ==============================================================================
# Copiez ce fichier vers .env et modifiez les valeurs selon vos besoins
# ATTENTION: Ne JAMAIS commiter le fichier .env avec des credentials réels !
# ==============================================================================

# ==============================================================================
# PostgreSQL - Base de données
# ==============================================================================
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres

# ==============================================================================
# Airflow - Configuration
# ==============================================================================
# Executor: LocalExecutor pour dev/démo, CeleryExecutor pour production
AIRFLOW__CORE__EXECUTOR=LocalExecutor

# Connexion à la base de données Airflow
AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=postgresql+psycopg2://airflow:airflow@postgres/airflow

# Clé de chiffrement Fernet (générer avec: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())")
# IMPORTANT: Changez cette valeur en production !
AIRFLOW__CORE__FERNET_KEY=

# Configuration DAGs
AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION=true
AIRFLOW__CORE__LOAD_EXAMPLES=false

# API Backend
AIRFLOW__API__AUTH_BACKENDS=airflow.api.auth.backend.basic_auth,airflow.api.auth.backend.session

# Healthcheck
AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK=true

# Packages Python additionnels à installer
_PIP_ADDITIONAL_REQUIREMENTS=pandas psycopg2-binary boto3 scikit-learn pyarrow openpyxl

# Utilisateur Airflow (UID pour permissions Docker)
AIRFLOW_UID=50000

# Credentials Web UI
_AIRFLOW_WWW_USER_USERNAME=airflow
_AIRFLOW_WWW_USER_PASSWORD=airflow

# ==============================================================================
# MinIO - Data Lake S3-compatible
# ==============================================================================
MINIO_VERSION=latest
MINIO_HOSTNAME=minio

# Credentials MinIO (à changer en production !)
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin123

# Buckets à créer automatiquement
MINIO_DEFAULT_BUCKETS=bronze,silver,gold

# ==============================================================================
# Configuration ETL
# ==============================================================================
# Chemin vers les données sources
DATA_PATH=/opt/airflow/data

# Configuration du pipeline
ETL_BATCH_SIZE=1000
ETL_MAX_RETRIES=3

# ==============================================================================
# Machine Learning
# ==============================================================================
# Contamination pour IsolationForest (% d'anomalies attendues)
ML_CONTAMINATION=0.05

# Random seed pour reproductibilité
ML_RANDOM_STATE=42

# ==============================================================================
# Environnement
# ==============================================================================
# dev, staging, production
ENVIRONMENT=development

# Timezone
TZ=Europe/Paris
